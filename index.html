<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Sách Mẹo Nhớ Huyệt - Landing Page Chuyên Nghiệp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- TailwindCSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css"/>
  <!-- Google Fonts -->
  <link href="https://cdn.jsdelivr.net/npm/@fontsource/roboto@3.3.1/400.css" rel="stylesheet" />
  <style>
    html { scroll-behavior: smooth; }
    body { font-family: 'Roboto', Arial, sans-serif; background-color: #f8fafc;}
    .slider { position:relative; overflow: hidden; }
    .slider img { max-height: 330px; object-fit:cover; width: 100%; }
    .slider-btn { background: rgba(0,0,0,0.5); color: #fff; border: none; border-radius: 9999px; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center;}
    .floating-btn { position: fixed; bottom: 24px; right: 24px; z-index: 100; background-color: #e53e3e; color: #fff; border-radius: 9999px; padding: 16px 28px; box-shadow: 0 4px 16px rgba(0,0,0,0.18); font-size: 20px; font-weight: bold; cursor: pointer; transition: transform 0.14s;}
    .floating-btn:hover { transform: scale(1.04);}
    .marquee { overflow:hidden; white-space:nowrap; }
    .marquee span { display:inline-block; padding-right:32px; color:#283747;}
    .timer-item { display: flex; flex-direction: column; align-items: center;}
    .timer-digit { font-size: 1.8rem; font-weight: 700; color: #e53e3e; }
    .timer-label { font-size: .74rem; color: #555;}
    /* No horizontal scrolls in PDF export */
    ::-webkit-scrollbar {height:0;width:9px;background:#e2e8f0;}
    ::-webkit-scrollbar-thumb {background:#a0aec0;border-radius:6px;}
    @media print {
      .floating-btn, #effect-orders { display: none !important }
    }
  </style>
</head>
<body>
  <!-- Banner và Giá -->
  <div class="relative bg-gradient-to-br from-rose-100 via-pink-50 to-blue-50 pt-8 pb-2 px-3">
    <div class="max-w-5xl mx-auto flex flex-col md:flex-row items-center">
      <div class="w-full md:w-2/5 flex-shrink-0">
        <!-- Slider Ảnh Sách -->
        <div class="slider mt-2" id="book-slider">
          <img id="slider-image" src="https://images.unsplash.com/photo-1524985069026-dd778a71c7b4?auto=format&fit=crop&w=400&q=80" alt="Bìa sách Mẹo Nhớ Huyệt">
          <button id="slider-prev" class="slider-btn absolute top-1/2 left-2 transform -translate-y-1/2"><i class="fas fa-chevron-left"></i></button>
          <button id="slider-next" class="slider-btn absolute top-1/2 right-2 transform -translate-y-1/2"><i class="fas fa-chevron-right"></i></button>
        </div>
        <div class="text-center text-xs text-gray-500 mt-1">*Hình ảnh sách & nội dung thực tế</div>
      </div>
      <div class="w-full md:w-3/5 md:pl-10 md:mt-0 mt-8">
        <h1 class="text-3xl md:text-4xl font-extrabold text-rose-700 mb-1">MẸO NHỚ HUYỆT</h1>
        <div class="flex flex-col md:flex-row items-center md:space-x-6 my-3">
          <div>
            <div class="flex items-end space-x-2">
              <div class="text-lg text-gray-700 font-semibold opacity-80">Giá gốc:</div>
              <div class="text-xl line-through text-gray-500 opacity-70">500.000đ</div>
            </div>
            <div class="flex items-end space-x-2">
              <div class="text-lg text-gray-700 font-semibold opacity-80">Giá KM:</div>
              <div class="text-3xl font-bold text-green-600">229.000đ</div>
            </div>
            <div class="flex items-center text-sm mt-1">
              <span class="bg-yellow-300 text-yellow-900 px-2 py-1 rounded-lg font-semibold">Tiết kiệm 54%</span>
            </div>
          </div>
          <div class="mt-4 md:mt-0">
            <div class="flex items-end space-x-2">
              <div class="text-lg text-gray-700 font-semibold opacity-80">Combo (kèm <span class="underline">Liệu pháp chữa bệnh toàn Thân khu phản xạ</span>):</div>
            </div>
            <div class="flex items-end space-x-3 flex-wrap">
              <div class="text-lg line-through text-gray-500 opacity-70">708.000đ</div>
              <div class="text-2xl text-rose-700 font-bold">Chỉ còn 349.000đ</div>
              <span class="bg-blue-100 text-blue-800 rounded px-2 py-1 font-semibold">Combo giảm 359K</span>
            </div>
            <div class="text-xs text-green-600 mt-1 italic">*Số lượng khuyến mãi combo có hạn*</div>
          </div>
        </div>
        <!-- Đếm ngược thời gian -->
        <div class="flex items-center space-x-2 mt-4 mb-2">
          <div class="font-bold text-gray-700 flex items-center"><i class="fas fa-clock mr-1"></i> KHUYẾN MÃI KẾT THÚC SAU:</div>
          <div id="timer" class="flex space-x-2 ml-2"></div>
        </div>
        <div class="marquee mt-2">
          <span><i class="fas fa-gift text-rose-700"></i> Mua sách tặng video bài giảng & tài liệu hỗ trợ!</span>
          <span><i class="fas fa-shipping-fast text-green-600"></i> Freeship toàn quốc!</span>
          <span><i class="fas fa-phone-alt text-blue-600"></i> Tư vấn tận tình - Hỗ trợ 1-1!</span>
        </div>
      </div>
    </div>
  </div>
  <!-- Chính sách -->
  <div class="max-w-3xl mx-auto px-2 mt-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-base mb-1 ">
      <div class="flex items-center p-3 bg-white rounded-xl shadow-sm border ">
        <i class="fas fa-undo-alt text-2xl text-amber-500 mr-3"></i> <span>Đổi/trả dễ dàng trong 7 ngày</span>
      </div>
      <div class="flex items-center p-3 bg-white rounded-xl shadow-sm border ">
        <i class="fas fa-shipping-fast text-2xl text-blue-500 mr-3"></i> <span>Miễn phí giao hàng toàn quốc</span>
      </div>
      <div class="flex items-center p-3 bg-white rounded-xl shadow-sm border ">
        <i class="fas fa-shield-alt text-2xl text-green-600 mr-3"></i> <span>Bảo hành in lỗi nội dung đổi mới 1-1</span>
      </div>
    </div>
  </div>
  <!-- Nút Đặt hàng nổi -->
  <button onclick="scrollToOrder()" class="floating-btn shadow-xl flex items-center gap-2">
    <i class="fas fa-cart-plus text-2xl animate-bounce"></i> Đặt hàng ngay
  </button>
  <!-- Nội dung chi tiết chương sách -->
  <div class="max-w-5xl mx-auto px-2 lg:px-0 py-10" id="noidung">
    <h2 class="text-2xl md:text-3xl text-rose-800 font-bold mb-3">Nội dung chi tiết sách <span class="text-blue-700">MẸO NHỚ HUYỆT</span></h2>
    <div class="bg-white rounded-lg shadow-sm p-4 border">
      <h3 class="text-xl text-rose-700 font-semibold my-2">PHẦN 1: MẸO NHỚ HUYỆT – Quy tắc xác định chung</h3>
      <div class="space-y-2">
        <div>
          <strong>1. Vùng vai gáy lưng:</strong>
          <span class="text-gray-700 text-sm block mb-1">Phong Phủ, Phong Trì, Đại Chùy, Thân Trụ, Chí Dương, Kiên Ngung, Kiên Tỉnh, Kiên Trinh, Nhu Du, Cánh Cân, Thiên Tông, Cao Hoang, Phế Du, Tâm Du, Cách Du, Can Du, Đởm Du, Tỳ Du, Vị Du, Thận Du, Chí Thất, Mệnh Môn, Yêu Nhãn, Bát Liêu, Trật Biên, Hoàn Khiêu</span>
        </div>
        <div>
          <strong>2. Vùng tay:</strong>
          <span class="text-gray-700 text-sm block mb-1">Thiếu Thương, Lao Cung, Ngư Tế, Thần Môn, Đại Lăng, Nội Quan, Liệt Khuyết, Xích Trạch, Hợp Cốc, Lạc Chẩm, Trung Chử, Ngoại Quan, Thủ Tam Lý, Khúc Trì, Tỳ Nhu, Tiểu Hải</span>
        </div>
        <div>
          <strong>3. Vùng ngực:</strong>
          <span class="text-gray-700 text-sm block mb-1">Vân Môn, Trung Phủ, Đản Trung, Thiên Đột, Ốc Ế, Thiên Trì, Nhũ Căn, Kỳ Môn</span>
        </div>
        <div>
          <strong>4. Vùng bụng:</strong>
          <span class="text-gray-700 text-sm block mb-1">Cự Khuyết, Chương Môn, Trung Quản, Thần Khuyết, Khí Hải</span>
        </div>
        <div>
          <strong>5. Vùng chân mặt trước:</strong>
          <span class="text-gray-700 text-sm block mb-1">Quan Nguyên, Thiên Khu, Lương Môn, Trung Cực, Trung Đột, Âm Lăng Tuyền, Huyết Hải, Lương Khâu, Thừa Phù, Phong Thị, Ủy Trung</span>
        </div>
        <div>
          <strong>6. Vùng chân mặt sau:</strong>
          <span class="text-gray-700 text-sm block mb-1">Bách Trung Độc, Trung Độc, Dương Bạch, Thừa Khấp, Túc Khổng, Nghinh Hương, Tình Minh, Thái Dương, Tình Túc, Túc Tam Lý, Thừa Sơn, Âm Giao, Túc Thái Dương, Quyền Liêu</span>
        </div>
        <div>
          <strong>7. Vùng đầu - mặt:</strong>
          <span class="text-gray-700 text-sm block mb-1">Nhân Trung, Thừa Tương, Địa Thương, Giáp Xa, Hạ Quan, Thính Cung, Nhĩ Môn, Ế Phong, Ấn Đường, Ngạch Trung, Thần Đình, Đầu Duy, Suất Cốc, Bách Hội, Tứ Thần Thông</span>
        </div>
      </div>
      <h3 class="text-xl text-rose-700 font-semibold mt-5 mb-2">PHẦN 2: Ứng dụng ấn huyệt trong chăm sóc sức khỏe tại nhà</h3>
      <div>
        <div>
          <strong>Chương 1: Phạm vi, Phương pháp và Quy tắc ấn huyệt</strong>
          <span class="block text-gray-700 text-sm">Hướng dẫn căn bản về cách xác định, thao tác, và lưu ý an toàn trong quá trình thực hành bấm - ấn huyệt.</span>
        </div>
        <div class="mt-2">
          <strong>Chương 2: Thực hành ấn huyệt cho các triệu chứng thường gặp</strong>
          <ul class="list-disc list-inside text-gray-800 text-sm mt-1 grid md:grid-cols-2 gap-x-6">
            <li>Nhức mỏi mắt</li><li>Ù tai</li><li>Viêm xoang</li>
            <li>Trị ho rát họng</li><li>Giúp tăng cường trí nhớ</li>
            <li>Đau đầu</li><li>Cải thiện rối loạn tiền đình</li>
            <li>Đau dây thần kinh số V, VII</li>
            <li>Viêm quanh khớp vai</li>
            <li>Đau tê vai cánh tay</li>
            <li>Đau lưng hông</li>
            <li>Ra mồ hôi tay</li>
            <li>Hội chứng ống cổ tay</li>
            <li>Chuột rút/căng chân</li>
            <li>Đau gót chân</li>
            <li>Tăng cường sinh lý</li>
            <li>Đau thần kinh tọa</li>
            <li>Tắc tia sữa</li>
            <li>Đau dây thần kinh liên sườn</li>
            <li>Chướng bụng đầy hơi</li>
            <li>Táo bón</li><li>Đau bụng kinh</li>
            <li>Say tàu xe</li><li>Nấc</li>
            <li>Mất ngủ</li><li>Cảm cúm</li>
            <li>Phục hồi sau tai biến</li>
            <li>Huyết áp cao/thấp</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <!-- Slider ảnh minh họa nội dung sách -->
  <div class="max-w-5xl mx-auto px-2 flex flex-wrap gap-4 py-6 justify-center" id="illustrations">
    <img src="https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=350&q=80" alt="Nội dung minh họa 1" class="rounded-lg shadow-sm border w-48 h-64 object-cover">
    <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=350&q=80" alt="Nội dung minh họa 2" class="rounded-lg shadow-sm border w-48 h-64 object-cover">
    <img src="https://images.unsplash.com/photo-1453928582365-b6ad33cbcf64?auto=format&fit=crop&w=350&q=80" alt="Nội dung minh họa 3" class="rounded-lg shadow-sm border w-48 h-64 object-cover">
    <img src="https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?auto=format&fit=crop&w=350&q=80" alt="Nội dung minh họa 4" class="rounded-lg shadow-sm border w-48 h-64 object-cover">
  </div>
  <!-- Đánh giá khách hàng -->
  <div class="max-w-5xl mx-auto px-2 py-1">
    <h3 class="text-xl font-bold text-gray-800 mb-3">Đánh giá thực tế từ khách hàng</h3>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="bg-white rounded-lg shadow border p-3 flex">
        <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Người đánh giá" class="rounded-full w-14 h-14 object-cover mr-3 mt-1 flex-shrink-0 border">
        <div>
          <div class="flex items-center space-x-2">
            <span class="font-semibold text-gray-700">Nguyễn Văn Mẫn</span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
          </div>
          <div class="text-gray-600 text-sm mt-1 italic">"Sách dễ hiểu, phần mẹo ghi nhớ cực kỳ hữu ích, ứng dụng hàng ngày chăm sóc sức khỏe cho gia đình."</div>
          <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=200&q=80" class="mt-2 rounded shadow border w-24 h-24 object-cover" alt="Đọc sách thực tế">
        </div>
      </div>
      <div class="bg-white rounded-lg shadow border p-3 flex">
        <img src="https://randomuser.me/api/portraits/women/45.jpg" alt="Người đánh giá" class="rounded-full w-14 h-14 object-cover mr-3 mt-1 flex-shrink-0 border">
        <div>
          <div class="flex items-center space-x-2">
            <span class="font-semibold text-gray-700">Trần Huyền Trang</span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
          </div>
          <div class="text-gray-600 text-sm mt-1 italic">"Mình là mẹ bỉm, đọc sách này biết bấm huyệt giảm đau vai gáy, hỗ trợ chăm sóc em bé rất tốt. Shop còn tặng thêm video hướng dẫn chi tiết!"</div>
          <img src="https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=200&q=80" class="mt-2 rounded shadow border w-24 h-24 object-cover" alt="Ảnh thực tế sách">
        </div>
      </div>
      <div class="bg-white rounded-lg shadow border p-3 flex">
        <img src="https://randomuser.me/api/portraits/men/83.jpg" alt="Người đánh giá" class="rounded-full w-14 h-14 object-cover mr-3 mt-1 flex-shrink-0 border">
        <div>
          <div class="flex items-center space-x-2">
            <span class="font-semibold text-gray-700">Bùi Tuấn Hưng</span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
            <span class="text-yellow-500"><i class="fas fa-star"></i></span>
          </div>
          <div class="text-gray-600 text-sm mt-1 italic">"Hình ảnh, chú thích rõ ràng dễ học. Combo 2 cuốn siêu tiết kiệm, giao hàng nhanh, đóng gói kỹ."</div>
          <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=200&q=80" class="mt-2 rounded shadow border w-24 h-24 object-cover" alt="Đánh giá sách combo">
        </div>
      </div>
    </div>
  </div>
  <!-- Hiệu ứng người đã đặt -->
  <div id="effect-orders"></div>
  <!-- Form đặt hàng -->
  <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-xl my-9 p-6 border" id="order-section">
    <h2 class="text-2xl font-bold text-rose-700 mb-2">Đặt mua sách ngay</h2>
    <form id="order-form" class="space-y-4">
      <input type="hidden" name="date" id="form-date">
      <div>
        <label class="font-semibold block mb-1 text-sm">Họ và tên <span class="text-rose-500">*</span></label>
        <input name="name" required type="text" class="w-full border px-3 py-2 rounded outline-none focus:ring-2 focus:ring-blue-300" autocomplete="off">
      </div>
      <div>
        <label class="font-semibold block mb-1 text-sm">Số điện thoại <span class="text-rose-500">*</span></label>
        <input name="phone" required pattern="^0[0-9]{9,10}$" maxlength="11" type="tel" class="w-full border px-3 py-2 rounded outline-none focus:ring-2 focus:ring-blue-300" autocomplete="off" placeholder="VD: 0912345678">
      </div>
      <div>
        <label class="font-semibold block mb-1 text-sm">Địa chỉ <span class="text-rose-500">*</span></label>
        <div class="flex flex-wrap gap-2 mb-1">
          <select id="city" required class="border rounded px-2 py-1" autocomplete="off">
            <option value="">Chọn Tỉnh/TP</option>
          </select>
          <select id="district" required disabled class="border rounded px-2 py-1" autocomplete="off">
            <option value="">Chọn Quận/Huyện</option>
          </select>
          <select id="ward" required disabled class="border rounded px-2 py-1" autocomplete="off">
            <option value="">Chọn Phường/Xã</option>
          </select>
        </div>
        <input type="text" name="address" required readonly class="w-full border px-3 py-2 rounded bg-gray-100" id="final_address" autocomplete="off" placeholder="Địa chỉ cụ thể (Tỉnh/TP, Quận/Huyện, Phường/Xã)">
      </div>
      <div>
        <label class="font-semibold block mb-1 text-sm">Đặt mua</label>
        <select name="don_hang" required class="w-full border rounded px-3 py-2">
          <option value="Mẹo Nhớ Huyệt - 229K">Mẹo Nhớ Huyệt (229.000đ)</option>
          <option value="Liệu pháp chữa bệnh toàn Thân khu phản xạ - 179K">Liệu pháp chữa bệnh toàn Thân khu phản xạ (179.000đ)</option>
          <option value="Combo cả 2 sách - 349K">Combo cả 2 sách (Cực ưu đãi 349.000đ)</option>
        </select>
      </div>
      <div>
        <label class="font-semibold block mb-1 text-sm">Ghi chú thêm cho shop <span class="text-xs text-gray-400 italic">(tuỳ chọn)</span></label>
        <textarea name="Note" class="w-full border px-3 py-2 rounded" rows="2" maxlength="255" placeholder="Ví dụ: Giao ngoài giờ hành chính, tặng thêm túi vải,..."></textarea>
      </div>
      <div>
        <button type="submit" class="w-full py-3 rounded bg-rose-700 text-white font-semibold text-lg shadow hover:bg-rose-800 transition-colors">Xác nhận đặt hàng</button>
      </div>
    </form>
    <div id="form-success" class="hidden mt-4 text-center text-green-700 bg-green-100 p-4 rounded shadow text-lg font-semibold">
      <i class="fas fa-check-circle text-2xl"></i> <br>
      Đặt hàng thành công! Shop sẽ liên hệ xác nhận trong ít phút nữa. Xin cảm ơn quý khách!
    </div>
    <div id="form-error" class="hidden mt-4 text-center text-red-700 bg-red-100 p-3 rounded shadow text-lg font-semibold">
      Đã xảy ra lỗi, vui lòng thử lại hoặc đặt hàng qua số hotline <b>0988.XXX.XXX</b>
    </div>
  </div>
  <script>
    // Dữ liệu slider sách
    const sliderImages = [
      "https://images.unsplash.com/photo-1524985069026-dd778a71c7b4?auto=format&fit=crop&w=400&q=80", // Bìa sách
      "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80", // Trang minh họa
      "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80",  // Trang bài học trong sách
      "https://images.unsplash.com/photo-1453928582365-b6ad33cbcf64?auto=format&fit=crop&w=400&q=80", // Trích đoạn hướng dẫn
      "https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?auto=format&fit=crop&w=400&q=80", // Ứng dụng huyệt
    ];
    let sliderIdx = 0;
    function updateSlider() {
      document.getElementById('slider-image').src = sliderImages[sliderIdx];
    }
    document.getElementById('slider-prev').onclick = function() {
      sliderIdx = (sliderIdx === 0) ? sliderImages.length - 1 : sliderIdx - 1;
      updateSlider();
    }
    document.getElementById('slider-next').onclick = function() {
      sliderIdx = (sliderIdx + 1) % sliderImages.length;
      updateSlider();
    }
    // --- Countdown Timer
    function updateTimer() {
      // Sale ends in 3 days from now!
      var saleEnd = new Date();
      saleEnd.setDate(saleEnd.getDate() + 3);
      saleEnd.setHours(23,59,59,0);
      var now = new Date();
      var diff = saleEnd - now;
      if (diff < 0) diff = 0;
      var d = Math.floor(diff/86400000),
          h = Math.floor((diff%86400000)/3600000),
          m = Math.floor((diff%3600000)/60000),
          s = Math.floor((diff%60000)/1000);
      document.getElementById('timer').innerHTML = `
        <div class="timer-item"><span class="timer-digit">${d}</span><span class="timer-label">ngày</span></div>
        <div class="timer-digit">:</div>
        <div class="timer-item"><span class="timer-digit">${String(h).padStart(2,'0')}</span><span class="timer-label">giờ</span></div>
        <div class="timer-digit">:</div>
        <div class="timer-item"><span class="timer-digit">${String(m).padStart(2,'0')}</span><span class="timer-label">phút</span></div>
        <div class="timer-digit">:</div>
        <div class="timer-item"><span class="timer-digit">${String(s).padStart(2,'0')}</span><span class="timer-label">giây</span></div>`;
      setTimeout(updateTimer, 1000);
    }
    updateTimer();

    // Nút Đặt hàng nổi
    function scrollToOrder(){
      document.getElementById("order-section").scrollIntoView({behavior: 'smooth', block: 'start'});
    }

    // Giao diện chọn thành phố, quận huyện, phường xã
    let citySelect = document.getElementById("city"), districtSelect = document.getElementById("district"), wardSelect = document.getElementById("ward"), addressInput = document.getElementById("final_address");
    let dataAddress = {};
    fetch('https://provinces.open-api.vn/api/?depth=3')
      .then(res=>res.json())
      .then(data=>{
        dataAddress = data;
        // Load tỉnh/thành
        data.forEach(tp => {
          var op = document.createElement('option');
          op.value = tp.name;
          op.text = tp.name;
          citySelect.appendChild(op);
        });
      });
    citySelect.onchange = function() {
      let val = citySelect.value, dis=[];
      districtSelect.innerHTML = '<option value="">Chọn Quận/Huyện</option>';
      wardSelect.innerHTML = '<option value="">Chọn Phường/Xã</option>';
      wardSelect.disabled = true;
      if (val==='') {districtSelect.disabled=true;return;}
      let tp = dataAddress.find(item => item.name === val);
      tp.districts.forEach(qh => {
        var op = document.createElement('option'); op.value=qh.name; op.text=qh.name;
        districtSelect.appendChild(op);
      });
      districtSelect.disabled=false;
      updateAddress();
    }
    districtSelect.onchange = function() {
      let valCity = citySelect.value;
      let valDistrict = districtSelect.value;
      wardSelect.innerHTML = '<option value="">Chọn Phường/Xã</option>';
      if (valDistrict==='') {wardSelect.disabled=true;return;}
      let tp = dataAddress.find(item => item.name===valCity);
      let qh = tp.districts.find(dist=> dist.name===valDistrict);
      qh.wards.forEach(xa=>{
        var op = document.createElement('option'); op.value=xa.name; op.text=xa.name;
        wardSelect.appendChild(op);
      });
      wardSelect.disabled=false;
      updateAddress();
    }
    wardSelect.onchange = updateAddress;
    function updateAddress(){
      let parts = [];
      if(wardSelect.value) parts.push(wardSelect.value);
      if(districtSelect.value) parts.push(districtSelect.value);
      if(citySelect.value) parts.push(citySelect.value);
      addressInput.value = parts.join(', ');
    }
    // --- Form đặt hàng
    document.getElementById('form-date').value = new Date().toLocaleString('vi-VN');
    document.getElementById('order-form').onsubmit = function(e){
      e.preventDefault();
      // Validate
      var fd = new FormData(e.target);
      let address = document.getElementById("final_address").value.trim();
      if (!address) { alert("Vui lòng chọn đầy đủ Tỉnh/Thành, Quận/Huyện, Phường/Xã"); return false; }
      fd.set('address', address);
      // Google Sheet DB endpoint
      fetch('https://sheetdb.io/api/v1/fg5880qtxha50', {
        method:'POST',
        body: fd,
      }).then(r=>r.json()).then(d=>{
        if(d.created||d.length||d.success){
          document.getElementById('order-form').classList.add('hidden');
          document.getElementById('form-success').classList.remove('hidden');
          document.getElementById('form-error').classList.add('hidden');
        }
        else throw new Error('Not success');
      }).catch(err=>{
        document.getElementById('form-error').classList.remove('hidden');
      });
      return false;
    };

    // Hiệu ứng người đã đặt hàng
    const fakeOrders = [
      {name:"Chị Ngọc", city:"Hà Nội", product:"Combo 2 sách", time:"2 phút trước"},
      {name:"Anh Tuấn", city:"Hải Phòng", product:"Mẹo Nhớ Huyệt", time:"5 phút trước"},
      {name:"Cô Huệ", city:"Đà Nẵng", product:"Liệu pháp chữa bệnh", time:"7 phút trước"},
      {name:"Hùng", city:"TP.HCM", product:"Combo 2 sách", time:"12 phút trước"},
      {name:"Trà My", city:"Cần Thơ", product:"Mẹo Nhớ Huyệt", time:"20 phút trước"},
      {name:"Chị Hà", city:"Bắc Ninh", product:"Mẹo Nhớ Huyệt", time:"23 phút trước"},
      {name:"Ngọc Dũng", city:"Vinh", product:"Combo 2 sách", time:"29 phút trước"},
      {name:"Tiến", city:"Hà Nội", product:"Liệu pháp chữa bệnh", time:"45 phút trước"},
    ];
    let orderIdx = 0;
    function showOrderEffect(){
      let o = fakeOrders[orderIdx];
      if(!o) orderIdx=0,o=fakeOrders[0];
      let div = document.createElement("div");
      div.className = "fixed left-4 bottom-8 bg-white shadow-xl px-5 py-3 rounded-2xl flex items-center space-x-3 border border-green-600 z-50 animate-bounceIn";
      div.innerHTML = `<i class="fas fa-user-circle text-green-600 text-2xl"></i>
        <div><b>${o.name}</b> - <span class="text-sm">${o.city}</span><br>
          <span class="text-blue-700 font-semibold">${o.product}</span><br>
          <span class="text-xs italic text-gray-400">${o.time}</span></div>`;
      document.body.appendChild(div);
      setTimeout(()=>{ div.classList.add('opacity-0'); setTimeout(()=>div.remove(), 600); }, 3800 + Math.random()*1200);
      orderIdx = (orderIdx+1)%fakeOrders.length;
      setTimeout(showOrderEffect, 5200+Math.random()*1500);
    }
    showOrderEffect();

    // --- Animate BounceIn
    var style = document.createElement('style');
    style.innerHTML = `
      @keyframes bounceIn{
        0% {transform: scale(0.5) translateY(80px); opacity:0;}
        50% {transform: scale(1.12) translateY(-10px);}
        75% {transform: scale(0.96) translateY(2px);}
        100% {transform: scale(1) translateY(0); opacity:1;}
      }
      .animate-bounceIn {
        animation: bounceIn 1s cubic-bezier(.7,-0.5,.2,1.6);
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>

